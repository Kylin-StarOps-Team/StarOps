<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StarOps AI系统监控助手</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
</head>
<body>
    <div class="app-container">
        <!-- 顶部控制栏 -->
        <div class="top-control-bar">
            <!-- 左侧调试面板控制 -->
            <div class="left-controls">
                <button class="control-btn" id="toggleDataPanel" title="数据面板">
                    <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M2 3H12M2 7H12M2 11H12" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"/>
                    </svg>
                </button>
            </div>
            
            <!-- 中间导航 -->
            <div class="center-navigation">
                <button class="nav-btn active" data-view="chat">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                    </svg>
                    <span class="nav-text">AI对话</span>
                </button>
                <button class="nav-btn" data-view="web-reports">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M21 12V7l-3-1-2-3H8l-2 3-3 1v5l3 1 2 3h8l2-3 3-1z"></path>
                        <circle cx="12" cy="12" r="3"></circle>
                    </svg>
                    <span class="nav-text">Web检测</span>
                </button>
                <button class="nav-btn" data-view="mysql-reports">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                        <line x1="16" y1="2" x2="16" y2="6"></line>
                        <line x1="8" y1="2" x2="8" y2="6"></line>
                        <line x1="3" y1="10" x2="21" y2="10"></line>
                    </svg>
                    <span class="nav-text">MySQL优化</span>
                </button>
            </div>
            
            <!-- 右侧控制按钮 -->
            <div class="right-controls">
                <button class="control-btn" id="toggleConsolePanel" title="控制台">
                    <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M2 3L6 7L2 11M7 11H12" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </button>
                <button class="control-btn" id="historyBtn" title="历史管理">
                    <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M7 1C10.314 1 13 3.686 13 7s-2.686 6-6 6c-1.657 0-3.156-.673-4.243-1.757M1 7c0-3.314 2.686-6 6-6" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"/>
                        <path d="M7 4v3l2 2" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"/>
                    </svg>
                </button>
                <button class="control-btn" id="clearChatBtn" title="清空对话">
                    <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M2 3H12M4 3V2C4 1.44772 4.44772 1 5 1H9C9.55228 1 10 1.44772 10 2V3M6 6V10M8 6V10" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"/>
                    </svg>
                </button>
                <button class="control-btn" id="minimizeBtn" title="最小化">
                    <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M3 7H11" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"/>
                    </svg>
                </button>
                <button class="control-btn" id="maximizeBtn" title="最大化">
                    <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M3 3H11V11H3V3Z" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </button>
                <button class="control-btn" id="closeBtn" title="关闭">
                    <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M11 3L3 11M3 3L11 11" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"/>
                    </svg>
                </button>
            </div>
        </div>

        <!-- 主内容区域 -->
        <main class="app-main">
            <!-- 左侧数据面板 -->
            <div class="side-panel left-panel" id="dataPanel">
                <div class="panel-header">
                    <div class="panel-title">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M2 4H14M2 8H14M2 12H14" stroke="currentColor" stroke-width="1.5"/>
                        </svg>
                        AI分析数据
                    </div>
                    <button class="panel-close" onclick="toggleDataPanel()">×</button>
                </div>
                <div class="panel-content" id="dataPanelContent">
                    <div class="panel-placeholder">暂无分析数据</div>
                </div>
            </div>

            <!-- 中间内容区域 -->
            <div class="main-content">
                <!-- AI对话视图 -->
                <div class="view-content active" id="chatView">
                    <div class="chat-container">
                        <div class="chat-messages" id="chatMessages">
                        <!-- 欢迎消息 -->
                        <div class="message-group">
                            <div class="message assistant-message">
                                <div class="message-avatar">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M12 2L2 7L12 12L22 7L12 2Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
                                        <path d="M2 17L12 22L22 17" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
                                        <path d="M2 12L12 17L22 12" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
                                    </svg>
                                </div>
                                <div class="message-content">
                                    <div class="message-text">
                                        <h2>👋 欢迎使用StarOps AI智能监控助手</h2>
                                        
                                        <p>我是您的专业系统运维助手，支持<strong>10+种监控协议</strong>，为您提供全方位的系统监控和安全检测服务。</p>
                                        
                                        <h3>🚀 核心能力</h3>
                                        <ul>
                                            <li><strong>系统监控</strong> - CPU、内存、磁盘、网络实时监控</li>
                                            <li><strong>数据库优化</strong> - MySQL性能分析和配置优化</li>
                                            <li><strong>安全检测</strong> - 容器安全扫描、Web应用检测</li>
                                            <li><strong>智能修复</strong> - 自动问题诊断和修复建议</li>
                                            <li><strong>分布式追踪</strong> - 微服务监控和异常检测</li>
                                        </ul>
                                        
                                        <h3>💬 使用示例</h3>
                                        <div class="example-queries">
                                            <div class="query-example">"检查系统CPU和内存使用情况"</div>
                                            <div class="query-example">"分析MySQL数据库性能并优化配置"</div>
                                            <div class="query-example">"扫描Docker镜像的安全漏洞"</div>
                                            <div class="query-example">"检测网站配置和性能问题"</div>
                                        </div>
                                        
                                        <p>💡 <strong>小贴士</strong>：直接用自然语言描述您的问题，我会自动选择最适合的监控工具为您分析。</p>
                                    </div>
                                    <div class="message-time" id="welcomeTime"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 极简输入区域 -->
                    <div class="chat-input-area">
                        <div class="input-container">
                            <div class="input-wrapper">
                                <input 
                                    type="text"
                                    id="chatInput" 
                                    placeholder="输入您的问题..." 
                                    maxlength="2000"
                                />
                                <button class="send-btn" id="sendBtn">
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M14 2L7 9M14 2L10 14L7 9M14 2L2 6L7 9" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Web检测报告视图 -->
            <div class="view-content" id="webReportsView">
                <div class="reports-container">
                    <div class="reports-header">
                        <h1>🌐 Web检测报告</h1>
                        <button class="refresh-btn" id="refreshWebReports">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M13.5 3.5C12.2 2.2 10.4 1.5 8.5 1.5C4.9 1.5 2 4.4 2 8C2 11.6 4.9 14.5 8.5 14.5C11.3 14.5 13.7 12.6 14.3 10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                <path d="M11 3.5H13.5V6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            刷新
                        </button>
                    </div>
                    <div class="reports-grid" id="webReportsGrid">
                        <div class="loading-state">正在加载Web检测报告...</div>
                    </div>
                </div>
            </div>

            <!-- MySQL优化报告视图 -->
            <div class="view-content" id="mysqlReportsView">
                <div class="reports-container">
                    <div class="reports-header">
                        <h1>🗃️ MySQL优化报告</h1>
                        <button class="refresh-btn" id="refreshMysqlReports">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M13.5 3.5C12.2 2.2 10.4 1.5 8.5 1.5C4.9 1.5 2 4.4 2 8C2 11.6 4.9 14.5 8.5 14.5C11.3 14.5 13.7 12.6 14.3 10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                <path d="M11 3.5H13.5V6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            刷新
                        </button>
                    </div>
                    <div class="reports-grid" id="mysqlReportsGrid">
                        <div class="loading-state">正在加载MySQL优化报告...</div>
                    </div>
                </div>
            </div>
            </div>
            
            <!-- 右侧控制台面板 -->
            <div class="side-panel right-panel" id="consolePanel">
                <div class="panel-header">
                    <div class="panel-title">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M2 3L6 7L2 11M7 11H14" stroke="currentColor" stroke-width="1.5"/>
                        </svg>
                        调试控制台
                    </div>
                    <button class="panel-close" onclick="toggleConsolePanel()">×</button>
                </div>
                <div class="panel-content" id="consolePanelContent">
                    <div class="panel-placeholder">暂无控制台输出</div>
                </div>
            </div>
        </main>


    </div>

    <!-- 历史管理弹窗 -->
    <div class="modal" id="historyModal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>对话历史管理</h3>
                <button class="modal-close" id="closeHistoryModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="history-stats">
                    <div class="stat-item">
                        <span class="stat-label">对话轮次:</span>
                        <span class="stat-value" id="historyCount">0</span>
                    </div>
                </div>
                
                <div class="history-actions">
                    <button class="history-btn" id="viewHistoryBtn">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                            <path d="M8 2C11.314 2 14 4.686 14 8s-2.686 6-6 6c-1.657 0-3.156-.673-4.243-1.757M2 8c0-3.314 2.686-6 6-6" stroke="currentColor" stroke-width="1.5"/>
                        </svg>
                        查看历史
                    </button>
                    <button class="history-btn export-btn" id="exportHistoryBtn">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                            <path d="M8 1v10M5 8l3 3 3-3M3 14h10" stroke="currentColor" stroke-width="1.5"/>
                        </svg>
                        导出历史
                    </button>
                    <button class="history-btn danger-btn" id="clearHistoryBtn">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                            <path d="M3 4h10M5 4V3c0-.552.448-1 1-1h4c.552 0 1 .448 1 1v1M7 7v4M9 7v4" stroke="currentColor" stroke-width="1.5"/>
                        </svg>
                        清空历史
                    </button>
                </div>

                <div class="history-preview" id="historyPreview" style="display: none;">
                    <h4>历史预览</h4>
                    <div class="history-content" id="historyContent"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- 加载必要的JavaScript库 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/9.1.6/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="renderer.js"></script>
</body>
</html>
